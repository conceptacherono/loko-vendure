import { createBulkDeleteAction, Permission } from '@vendure/admin-ui/core';
import { map, mergeMap } from 'rxjs/operators';
export const deleteChannelsBulkAction = createBulkDeleteAction({
    location: 'channel-list',
    requiresPermission: userPermissions => userPermissions.includes(Permission.SuperAdmin) || userPermissions.includes(Permission.DeleteChannel),
    getItemName: item => item.code,
    bulkDelete: (dataService, ids) => {
        return dataService.settings.deleteChannels(ids).pipe(mergeMap(({ deleteChannels }) => dataService.auth.currentUser().single$.pipe(map(({ me }) => ({
            me,
            deleteChannels,
        })))), mergeMap(({ me, deleteChannels }) => 
        // eslint-disable-next-line @typescript-eslint/no-non-null-assertion
        dataService.client.updateUserChannels(me.channels).pipe(map(() => deleteChannels))));
    },
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY2hhbm5lbC1saXN0LWJ1bGstYWN0aW9ucy5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uLy4uL3NyYy9saWIvc2V0dGluZ3Mvc3JjL2NvbXBvbmVudHMvY2hhbm5lbC1saXN0L2NoYW5uZWwtbGlzdC1idWxrLWFjdGlvbnMudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsT0FBTyxFQUFFLHNCQUFzQixFQUE0QixVQUFVLEVBQUUsTUFBTSx3QkFBd0IsQ0FBQztBQUN0RyxPQUFPLEVBQUUsR0FBRyxFQUFFLFFBQVEsRUFBRSxNQUFNLGdCQUFnQixDQUFDO0FBRS9DLE1BQU0sQ0FBQyxNQUFNLHdCQUF3QixHQUFHLHNCQUFzQixDQUF1QztJQUNqRyxRQUFRLEVBQUUsY0FBYztJQUN4QixrQkFBa0IsRUFBRSxlQUFlLENBQUMsRUFBRSxDQUNsQyxlQUFlLENBQUMsUUFBUSxDQUFDLFVBQVUsQ0FBQyxVQUFVLENBQUMsSUFBSSxlQUFlLENBQUMsUUFBUSxDQUFDLFVBQVUsQ0FBQyxhQUFhLENBQUM7SUFDekcsV0FBVyxFQUFFLElBQUksQ0FBQyxFQUFFLENBQUMsSUFBSSxDQUFDLElBQUk7SUFDOUIsVUFBVSxFQUFFLENBQUMsV0FBVyxFQUFFLEdBQUcsRUFBRSxFQUFFO1FBQzdCLE9BQU8sV0FBVyxDQUFDLFFBQVEsQ0FBQyxjQUFjLENBQUMsR0FBRyxDQUFDLENBQUMsSUFBSSxDQUNoRCxRQUFRLENBQUMsQ0FBQyxFQUFFLGNBQWMsRUFBRSxFQUFFLEVBQUUsQ0FDNUIsV0FBVyxDQUFDLElBQUksQ0FBQyxXQUFXLEVBQUUsQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUN2QyxHQUFHLENBQUMsQ0FBQyxFQUFFLEVBQUUsRUFBRSxFQUFFLEVBQUUsQ0FBQyxDQUFDO1lBQ2IsRUFBRTtZQUNGLGNBQWM7U0FDakIsQ0FBQyxDQUFDLENBQ04sQ0FDSixFQUNELFFBQVEsQ0FBQyxDQUFDLEVBQUUsRUFBRSxFQUFFLGNBQWMsRUFBRSxFQUFFLEVBQUU7UUFDaEMsb0VBQW9FO1FBQ3BFLFdBQVcsQ0FBQyxNQUFNLENBQUMsa0JBQWtCLENBQUMsRUFBRyxDQUFDLFFBQVEsQ0FBQyxDQUFDLElBQUksQ0FBQyxHQUFHLENBQUMsR0FBRyxFQUFFLENBQUMsY0FBYyxDQUFDLENBQUMsQ0FDdEYsQ0FDSixDQUFDO0lBQ04sQ0FBQztDQUNKLENBQUMsQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGNyZWF0ZUJ1bGtEZWxldGVBY3Rpb24sIEdldENoYW5uZWxzUXVlcnksIEl0ZW1PZiwgUGVybWlzc2lvbiB9IGZyb20gJ0B2ZW5kdXJlL2FkbWluLXVpL2NvcmUnO1xyXG5pbXBvcnQgeyBtYXAsIG1lcmdlTWFwIH0gZnJvbSAncnhqcy9vcGVyYXRvcnMnO1xyXG5cclxuZXhwb3J0IGNvbnN0IGRlbGV0ZUNoYW5uZWxzQnVsa0FjdGlvbiA9IGNyZWF0ZUJ1bGtEZWxldGVBY3Rpb248SXRlbU9mPEdldENoYW5uZWxzUXVlcnksICdjaGFubmVscyc+Pih7XHJcbiAgICBsb2NhdGlvbjogJ2NoYW5uZWwtbGlzdCcsXHJcbiAgICByZXF1aXJlc1Blcm1pc3Npb246IHVzZXJQZXJtaXNzaW9ucyA9PlxyXG4gICAgICAgIHVzZXJQZXJtaXNzaW9ucy5pbmNsdWRlcyhQZXJtaXNzaW9uLlN1cGVyQWRtaW4pIHx8IHVzZXJQZXJtaXNzaW9ucy5pbmNsdWRlcyhQZXJtaXNzaW9uLkRlbGV0ZUNoYW5uZWwpLFxyXG4gICAgZ2V0SXRlbU5hbWU6IGl0ZW0gPT4gaXRlbS5jb2RlLFxyXG4gICAgYnVsa0RlbGV0ZTogKGRhdGFTZXJ2aWNlLCBpZHMpID0+IHtcclxuICAgICAgICByZXR1cm4gZGF0YVNlcnZpY2Uuc2V0dGluZ3MuZGVsZXRlQ2hhbm5lbHMoaWRzKS5waXBlKFxyXG4gICAgICAgICAgICBtZXJnZU1hcCgoeyBkZWxldGVDaGFubmVscyB9KSA9PlxyXG4gICAgICAgICAgICAgICAgZGF0YVNlcnZpY2UuYXV0aC5jdXJyZW50VXNlcigpLnNpbmdsZSQucGlwZShcclxuICAgICAgICAgICAgICAgICAgICBtYXAoKHsgbWUgfSkgPT4gKHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbWUsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRlbGV0ZUNoYW5uZWxzLFxyXG4gICAgICAgICAgICAgICAgICAgIH0pKSxcclxuICAgICAgICAgICAgICAgICksXHJcbiAgICAgICAgICAgICksXHJcbiAgICAgICAgICAgIG1lcmdlTWFwKCh7IG1lLCBkZWxldGVDaGFubmVscyB9KSA9PlxyXG4gICAgICAgICAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1ub24tbnVsbC1hc3NlcnRpb25cclxuICAgICAgICAgICAgICAgIGRhdGFTZXJ2aWNlLmNsaWVudC51cGRhdGVVc2VyQ2hhbm5lbHMobWUhLmNoYW5uZWxzKS5waXBlKG1hcCgoKSA9PiBkZWxldGVDaGFubmVscykpLFxyXG4gICAgICAgICAgICApLFxyXG4gICAgICAgICk7XHJcbiAgICB9LFxyXG59KTtcclxuIl19