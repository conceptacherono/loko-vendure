import { ApolloLink } from '@apollo/client/core';
import { omit } from '@vendure/common/lib/omit';
/**
 * The "__typename" property added by Apollo Client causes errors when posting the entity
 * back in a mutation. Therefore this link will remove all such keys before the object
 * reaches the API layer.
 *
 * See: https://github.com/apollographql/apollo-client/issues/1913#issuecomment-393721604
 */
export class OmitTypenameLink extends ApolloLink {
    constructor() {
        super((operation, forward) => {
            if (operation.variables) {
                operation.variables = omit(operation.variables, ['__typename'], true);
            }
            return forward ? forward(operation) : null;
        });
    }
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoib21pdC10eXBlbmFtZS1saW5rLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vc3JjL2xpYi9jb3JlL3NyYy9kYXRhL29taXQtdHlwZW5hbWUtbGluay50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxPQUFPLEVBQUUsVUFBVSxFQUFFLE1BQU0scUJBQXFCLENBQUM7QUFDakQsT0FBTyxFQUFFLElBQUksRUFBRSxNQUFNLDBCQUEwQixDQUFDO0FBRWhEOzs7Ozs7R0FNRztBQUNILE1BQU0sT0FBTyxnQkFBaUIsU0FBUSxVQUFVO0lBQzVDO1FBQ0ksS0FBSyxDQUFDLENBQUMsU0FBUyxFQUFFLE9BQU8sRUFBRSxFQUFFO1lBQ3pCLElBQUksU0FBUyxDQUFDLFNBQVMsRUFBRSxDQUFDO2dCQUN0QixTQUFTLENBQUMsU0FBUyxHQUFHLElBQUksQ0FBQyxTQUFTLENBQUMsU0FBUyxFQUFFLENBQUMsWUFBWSxDQUFDLEVBQUUsSUFBSSxDQUFDLENBQUM7WUFDMUUsQ0FBQztZQUVELE9BQU8sT0FBTyxDQUFDLENBQUMsQ0FBQyxPQUFPLENBQUMsU0FBUyxDQUFDLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQztRQUMvQyxDQUFDLENBQUMsQ0FBQztJQUNQLENBQUM7Q0FDSiIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEFwb2xsb0xpbmsgfSBmcm9tICdAYXBvbGxvL2NsaWVudC9jb3JlJztcclxuaW1wb3J0IHsgb21pdCB9IGZyb20gJ0B2ZW5kdXJlL2NvbW1vbi9saWIvb21pdCc7XHJcblxyXG4vKipcclxuICogVGhlIFwiX190eXBlbmFtZVwiIHByb3BlcnR5IGFkZGVkIGJ5IEFwb2xsbyBDbGllbnQgY2F1c2VzIGVycm9ycyB3aGVuIHBvc3RpbmcgdGhlIGVudGl0eVxyXG4gKiBiYWNrIGluIGEgbXV0YXRpb24uIFRoZXJlZm9yZSB0aGlzIGxpbmsgd2lsbCByZW1vdmUgYWxsIHN1Y2gga2V5cyBiZWZvcmUgdGhlIG9iamVjdFxyXG4gKiByZWFjaGVzIHRoZSBBUEkgbGF5ZXIuXHJcbiAqXHJcbiAqIFNlZTogaHR0cHM6Ly9naXRodWIuY29tL2Fwb2xsb2dyYXBocWwvYXBvbGxvLWNsaWVudC9pc3N1ZXMvMTkxMyNpc3N1ZWNvbW1lbnQtMzkzNzIxNjA0XHJcbiAqL1xyXG5leHBvcnQgY2xhc3MgT21pdFR5cGVuYW1lTGluayBleHRlbmRzIEFwb2xsb0xpbmsge1xyXG4gICAgY29uc3RydWN0b3IoKSB7XHJcbiAgICAgICAgc3VwZXIoKG9wZXJhdGlvbiwgZm9yd2FyZCkgPT4ge1xyXG4gICAgICAgICAgICBpZiAob3BlcmF0aW9uLnZhcmlhYmxlcykge1xyXG4gICAgICAgICAgICAgICAgb3BlcmF0aW9uLnZhcmlhYmxlcyA9IG9taXQob3BlcmF0aW9uLnZhcmlhYmxlcywgWydfX3R5cGVuYW1lJ10sIHRydWUpO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICByZXR1cm4gZm9yd2FyZCA/IGZvcndhcmQob3BlcmF0aW9uKSA6IG51bGw7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcbn1cclxuIl19