import { BehaviorSubject } from 'rxjs';
import { map } from 'rxjs/operators';
import { createBaseDetailResolveFn } from '../common/base-detail.component';
import { AngularRouteComponent } from './components/angular-route.component';
import { ROUTE_COMPONENT_OPTIONS } from './components/route.component';
/**
 * @description
 * Registers an Angular standalone component to be rendered in a route.
 *
 * @example
 * ```ts title="routes.ts"
 * import { registerRouteComponent } from '\@vendure/admin-ui/core';
 * import { registerReactRouteComponent } from '\@vendure/admin-ui/react';
 *
 * import { ProductReviewDetailComponent } from './components/product-review-detail/product-review-detail.component';
 * import { AllProductReviewsList } from './components/all-product-reviews-list/all-product-reviews-list.component';
 * import { GetReviewDetailDocument } from './generated-types';
 *
 * export default [
 *     registerRouteComponent({
 *         path: '',
 *         component: AllProductReviewsList,
 *         breadcrumb: 'Product reviews',
 *     }),
 *     registerRouteComponent({
 *         path: ':id',
 *         component: ProductReviewDetailComponent,
 *         query: GetReviewDetailDocument,
 *         entityKey: 'productReview',
 *         getBreadcrumbs: entity => [
 *             {
 *                 label: 'Product reviews',
 *                 link: ['/extensions', 'product-reviews'],
 *             },
 *             {
 *                 label: `#${entity?.id} (${entity?.product.name})`,
 *                 link: [],
 *             },
 *         ],
 *     }),
 * ];
 * ```
 *
 * @docsCategory routes
 */
export function registerRouteComponent(options) {
    const { query, entityKey, variables, getBreadcrumbs, locationId, description } = options;
    const breadcrumbSubject$ = new BehaviorSubject(options.breadcrumb ?? '');
    const titleSubject$ = new BehaviorSubject(options.title);
    if (getBreadcrumbs != null && (query == null || entityKey == null)) {
        console.error([
            `[${options.path ?? 'custom'} route] When using the "getBreadcrumbs" option, the "query" and "entityKey" options must also be provided.`,
            ``,
            `Alternatively, use the "breadcrumb" option instead, or use the "PageMetadataService" inside your Angular component`,
            `or the "usePageMetadata" React hook to set the breadcrumb.`,
        ].join('\n'));
    }
    const resolveFn = query && entityKey
        ? createBaseDetailResolveFn({
            query,
            entityKey,
            variables,
        })
        : undefined;
    return {
        path: options.path ?? '',
        providers: [
            {
                provide: ROUTE_COMPONENT_OPTIONS,
                useValue: {
                    component: options.component,
                    title$: titleSubject$,
                    breadcrumb$: breadcrumbSubject$,
                },
            },
            ...(options.routeConfig?.providers ?? []),
        ],
        ...(options.routeConfig ?? {}),
        resolve: { ...(resolveFn ? { detail: resolveFn } : {}), ...(options.routeConfig?.resolve ?? {}) },
        data: {
            locationId,
            description,
            breadcrumb: breadcrumbSubject$,
            ...(options.routeConfig?.data ?? {}),
            ...(getBreadcrumbs && query && entityKey
                ? {
                    breadcrumb: data => data.detail.entity.pipe(map((entity) => getBreadcrumbs(entity))),
                }
                : {}),
            ...(options.routeConfig?.data ?? {}),
        },
        component: AngularRouteComponent,
    };
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicmVnaXN0ZXItcm91dGUtY29tcG9uZW50LmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vc3JjL2xpYi9jb3JlL3NyYy9leHRlbnNpb24vcmVnaXN0ZXItcm91dGUtY29tcG9uZW50LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUlBLE9BQU8sRUFBRSxlQUFlLEVBQWMsTUFBTSxNQUFNLENBQUM7QUFDbkQsT0FBTyxFQUFFLEdBQUcsRUFBRSxNQUFNLGdCQUFnQixDQUFDO0FBQ3JDLE9BQU8sRUFBdUIseUJBQXlCLEVBQUUsTUFBTSxpQ0FBaUMsQ0FBQztBQUVqRyxPQUFPLEVBQUUscUJBQXFCLEVBQUUsTUFBTSxzQ0FBc0MsQ0FBQztBQUM3RSxPQUFPLEVBQUUsdUJBQXVCLEVBQUUsTUFBTSw4QkFBOEIsQ0FBQztBQTZCdkU7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztHQXVDRztBQUNILE1BQU0sVUFBVSxzQkFBc0IsQ0FNcEMsT0FBc0U7SUFDcEUsTUFBTSxFQUFFLEtBQUssRUFBRSxTQUFTLEVBQUUsU0FBUyxFQUFFLGNBQWMsRUFBRSxVQUFVLEVBQUUsV0FBVyxFQUFFLEdBQUcsT0FBTyxDQUFDO0lBRXpGLE1BQU0sa0JBQWtCLEdBQUcsSUFBSSxlQUFlLENBQWtCLE9BQU8sQ0FBQyxVQUFVLElBQUksRUFBRSxDQUFDLENBQUM7SUFDMUYsTUFBTSxhQUFhLEdBQUcsSUFBSSxlQUFlLENBQXFCLE9BQU8sQ0FBQyxLQUFLLENBQUMsQ0FBQztJQUU3RSxJQUFJLGNBQWMsSUFBSSxJQUFJLElBQUksQ0FBQyxLQUFLLElBQUksSUFBSSxJQUFJLFNBQVMsSUFBSSxJQUFJLENBQUMsRUFBRSxDQUFDO1FBQ2pFLE9BQU8sQ0FBQyxLQUFLLENBQ1Q7WUFDSSxJQUNJLE9BQU8sQ0FBQyxJQUFJLElBQUksUUFDcEIsNEdBQTRHO1lBQzVHLEVBQUU7WUFDRixvSEFBb0g7WUFDcEgsNERBQTREO1NBQy9ELENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUNmLENBQUM7SUFDTixDQUFDO0lBRUQsTUFBTSxTQUFTLEdBTVgsS0FBSyxJQUFJLFNBQVM7UUFDZCxDQUFDLENBQUMseUJBQXlCLENBQUM7WUFDdEIsS0FBSztZQUNMLFNBQVM7WUFDVCxTQUFTO1NBQ1osQ0FBQztRQUNKLENBQUMsQ0FBQyxTQUFTLENBQUM7SUFFcEIsT0FBTztRQUNILElBQUksRUFBRSxPQUFPLENBQUMsSUFBSSxJQUFJLEVBQUU7UUFDeEIsU0FBUyxFQUFFO1lBQ1A7Z0JBQ0ksT0FBTyxFQUFFLHVCQUF1QjtnQkFDaEMsUUFBUSxFQUFFO29CQUNOLFNBQVMsRUFBRSxPQUFPLENBQUMsU0FBUztvQkFDNUIsTUFBTSxFQUFFLGFBQWE7b0JBQ3JCLFdBQVcsRUFBRSxrQkFBa0I7aUJBQ0Y7YUFDcEM7WUFDRCxHQUFHLENBQUMsT0FBTyxDQUFDLFdBQVcsRUFBRSxTQUFTLElBQUksRUFBRSxDQUFDO1NBQzVDO1FBQ0QsR0FBRyxDQUFDLE9BQU8sQ0FBQyxXQUFXLElBQUksRUFBRSxDQUFDO1FBQzlCLE9BQU8sRUFBRSxFQUFFLEdBQUcsQ0FBQyxTQUFTLENBQUMsQ0FBQyxDQUFDLEVBQUUsTUFBTSxFQUFFLFNBQVMsRUFBRSxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsRUFBRSxHQUFHLENBQUMsT0FBTyxDQUFDLFdBQVcsRUFBRSxPQUFPLElBQUksRUFBRSxDQUFDLEVBQUU7UUFDakcsSUFBSSxFQUFFO1lBQ0YsVUFBVTtZQUNWLFdBQVc7WUFDWCxVQUFVLEVBQUUsa0JBQWtCO1lBQzlCLEdBQUcsQ0FBQyxPQUFPLENBQUMsV0FBVyxFQUFFLElBQUksSUFBSSxFQUFFLENBQUM7WUFDcEMsR0FBRyxDQUFDLGNBQWMsSUFBSSxLQUFLLElBQUksU0FBUztnQkFDcEMsQ0FBQyxDQUFDO29CQUNJLFVBQVUsRUFBRSxJQUFJLENBQUMsRUFBRSxDQUNmLElBQUksQ0FBQyxNQUFNLENBQUMsTUFBTSxDQUFDLElBQUksQ0FBQyxHQUFHLENBQUMsQ0FBQyxNQUFXLEVBQUUsRUFBRSxDQUFDLGNBQWMsQ0FBQyxNQUFNLENBQUMsQ0FBQyxDQUFDO2lCQUM1RTtnQkFDSCxDQUFDLENBQUMsRUFBRSxDQUFDO1lBQ1QsR0FBRyxDQUFDLE9BQU8sQ0FBQyxXQUFXLEVBQUUsSUFBSSxJQUFJLEVBQUUsQ0FBQztTQUN2QztRQUNELFNBQVMsRUFBRSxxQkFBcUI7S0FDbkIsQ0FBQztBQUN0QixDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgVHlwZSB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xyXG5pbXBvcnQgeyBSZXNvbHZlRm4sIFJvdXRlIH0gZnJvbSAnQGFuZ3VsYXIvcm91dGVyJztcclxuaW1wb3J0IHsgUmVzdWx0T2YsIFR5cGVkRG9jdW1lbnROb2RlIH0gZnJvbSAnQGdyYXBocWwtdHlwZWQtZG9jdW1lbnQtbm9kZS9jb3JlJztcclxuaW1wb3J0IHsgRG9jdW1lbnROb2RlIH0gZnJvbSAnZ3JhcGhxbCc7XHJcbmltcG9ydCB7IEJlaGF2aW9yU3ViamVjdCwgT2JzZXJ2YWJsZSB9IGZyb20gJ3J4anMnO1xyXG5pbXBvcnQgeyBtYXAgfSBmcm9tICdyeGpzL29wZXJhdG9ycyc7XHJcbmltcG9ydCB7IEJhc2VEZXRhaWxDb21wb25lbnQsIGNyZWF0ZUJhc2VEZXRhaWxSZXNvbHZlRm4gfSBmcm9tICcuLi9jb21tb24vYmFzZS1kZXRhaWwuY29tcG9uZW50JztcclxuaW1wb3J0IHsgQnJlYWRjcnVtYlZhbHVlIH0gZnJvbSAnLi4vcHJvdmlkZXJzL2JyZWFkY3J1bWIvYnJlYWRjcnVtYi5zZXJ2aWNlJztcclxuaW1wb3J0IHsgQW5ndWxhclJvdXRlQ29tcG9uZW50IH0gZnJvbSAnLi9jb21wb25lbnRzL2FuZ3VsYXItcm91dGUuY29tcG9uZW50JztcclxuaW1wb3J0IHsgUk9VVEVfQ09NUE9ORU5UX09QVElPTlMgfSBmcm9tICcuL2NvbXBvbmVudHMvcm91dGUuY29tcG9uZW50JztcclxuaW1wb3J0IHsgUm91dGVDb21wb25lbnRPcHRpb25zIH0gZnJvbSAnLi90eXBlcyc7XHJcblxyXG4vKipcclxuICogQGRlc2NyaXB0aW9uXHJcbiAqIENvbmZpZ3VyYXRpb24gZm9yIGEgcm91dGUgY29tcG9uZW50LlxyXG4gKlxyXG4gKiBAZG9jc0NhdGVnb3J5IHJvdXRlc1xyXG4gKi9cclxuZXhwb3J0IHR5cGUgUmVnaXN0ZXJSb3V0ZUNvbXBvbmVudE9wdGlvbnM8XHJcbiAgICBDb21wb25lbnQgZXh0ZW5kcyBhbnkgfCBCYXNlRGV0YWlsQ29tcG9uZW50PEVudGl0eT4sXHJcbiAgICBFbnRpdHkgZXh0ZW5kcyB7IGlkOiBzdHJpbmc7IHVwZGF0ZWRBdD86IHN0cmluZyB9LFxyXG4gICAgVCBleHRlbmRzIERvY3VtZW50Tm9kZSB8IFR5cGVkRG9jdW1lbnROb2RlPGFueSwgeyBpZDogc3RyaW5nIH0+LFxyXG4gICAgRmllbGQgZXh0ZW5kcyBrZXlvZiBSZXN1bHRPZjxUPixcclxuICAgIFIgZXh0ZW5kcyBGaWVsZCxcclxuPiA9IHtcclxuICAgIGNvbXBvbmVudDogVHlwZTxDb21wb25lbnQ+IHwgQ29tcG9uZW50O1xyXG4gICAgdGl0bGU/OiBzdHJpbmc7XHJcbiAgICBsb2NhdGlvbklkPzogc3RyaW5nO1xyXG4gICAgZGVzY3JpcHRpb24/OiBzdHJpbmc7XHJcbiAgICBicmVhZGNydW1iPzogQnJlYWRjcnVtYlZhbHVlO1xyXG4gICAgcGF0aD86IHN0cmluZztcclxuICAgIHF1ZXJ5PzogVDtcclxuICAgIGdldEJyZWFkY3J1bWJzPzogKGVudGl0eTogRXhjbHVkZTxSZXN1bHRPZjxUPltSXSwgJ1F1ZXJ5Jz4pID0+IEJyZWFkY3J1bWJWYWx1ZTtcclxuICAgIGVudGl0eUtleT86IENvbXBvbmVudCBleHRlbmRzIEJhc2VEZXRhaWxDb21wb25lbnQ8YW55PiA/IFIgOiBzdHJpbmc7XHJcbiAgICB2YXJpYWJsZXM/OiBUIGV4dGVuZHMgVHlwZWREb2N1bWVudE5vZGU8YW55LCBpbmZlciBWPiA/IE9taXQ8ViwgJ2lkJz4gOiBuZXZlcjtcclxuICAgIHJvdXRlQ29uZmlnPzogUm91dGU7XHJcbn0gJiAoQ29tcG9uZW50IGV4dGVuZHMgQmFzZURldGFpbENvbXBvbmVudDxhbnk+ID8geyBlbnRpdHlLZXk6IFIgfSA6IHVua25vd24pO1xyXG5cclxuLyoqXHJcbiAqIEBkZXNjcmlwdGlvblxyXG4gKiBSZWdpc3RlcnMgYW4gQW5ndWxhciBzdGFuZGFsb25lIGNvbXBvbmVudCB0byBiZSByZW5kZXJlZCBpbiBhIHJvdXRlLlxyXG4gKlxyXG4gKiBAZXhhbXBsZVxyXG4gKiBgYGB0cyB0aXRsZT1cInJvdXRlcy50c1wiXHJcbiAqIGltcG9ydCB7IHJlZ2lzdGVyUm91dGVDb21wb25lbnQgfSBmcm9tICdcXEB2ZW5kdXJlL2FkbWluLXVpL2NvcmUnO1xyXG4gKiBpbXBvcnQgeyByZWdpc3RlclJlYWN0Um91dGVDb21wb25lbnQgfSBmcm9tICdcXEB2ZW5kdXJlL2FkbWluLXVpL3JlYWN0JztcclxuICpcclxuICogaW1wb3J0IHsgUHJvZHVjdFJldmlld0RldGFpbENvbXBvbmVudCB9IGZyb20gJy4vY29tcG9uZW50cy9wcm9kdWN0LXJldmlldy1kZXRhaWwvcHJvZHVjdC1yZXZpZXctZGV0YWlsLmNvbXBvbmVudCc7XHJcbiAqIGltcG9ydCB7IEFsbFByb2R1Y3RSZXZpZXdzTGlzdCB9IGZyb20gJy4vY29tcG9uZW50cy9hbGwtcHJvZHVjdC1yZXZpZXdzLWxpc3QvYWxsLXByb2R1Y3QtcmV2aWV3cy1saXN0LmNvbXBvbmVudCc7XHJcbiAqIGltcG9ydCB7IEdldFJldmlld0RldGFpbERvY3VtZW50IH0gZnJvbSAnLi9nZW5lcmF0ZWQtdHlwZXMnO1xyXG4gKlxyXG4gKiBleHBvcnQgZGVmYXVsdCBbXHJcbiAqICAgICByZWdpc3RlclJvdXRlQ29tcG9uZW50KHtcclxuICogICAgICAgICBwYXRoOiAnJyxcclxuICogICAgICAgICBjb21wb25lbnQ6IEFsbFByb2R1Y3RSZXZpZXdzTGlzdCxcclxuICogICAgICAgICBicmVhZGNydW1iOiAnUHJvZHVjdCByZXZpZXdzJyxcclxuICogICAgIH0pLFxyXG4gKiAgICAgcmVnaXN0ZXJSb3V0ZUNvbXBvbmVudCh7XHJcbiAqICAgICAgICAgcGF0aDogJzppZCcsXHJcbiAqICAgICAgICAgY29tcG9uZW50OiBQcm9kdWN0UmV2aWV3RGV0YWlsQ29tcG9uZW50LFxyXG4gKiAgICAgICAgIHF1ZXJ5OiBHZXRSZXZpZXdEZXRhaWxEb2N1bWVudCxcclxuICogICAgICAgICBlbnRpdHlLZXk6ICdwcm9kdWN0UmV2aWV3JyxcclxuICogICAgICAgICBnZXRCcmVhZGNydW1iczogZW50aXR5ID0+IFtcclxuICogICAgICAgICAgICAge1xyXG4gKiAgICAgICAgICAgICAgICAgbGFiZWw6ICdQcm9kdWN0IHJldmlld3MnLFxyXG4gKiAgICAgICAgICAgICAgICAgbGluazogWycvZXh0ZW5zaW9ucycsICdwcm9kdWN0LXJldmlld3MnXSxcclxuICogICAgICAgICAgICAgfSxcclxuICogICAgICAgICAgICAge1xyXG4gKiAgICAgICAgICAgICAgICAgbGFiZWw6IGAjJHtlbnRpdHk/LmlkfSAoJHtlbnRpdHk/LnByb2R1Y3QubmFtZX0pYCxcclxuICogICAgICAgICAgICAgICAgIGxpbms6IFtdLFxyXG4gKiAgICAgICAgICAgICB9LFxyXG4gKiAgICAgICAgIF0sXHJcbiAqICAgICB9KSxcclxuICogXTtcclxuICogYGBgXHJcbiAqXHJcbiAqIEBkb2NzQ2F0ZWdvcnkgcm91dGVzXHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gcmVnaXN0ZXJSb3V0ZUNvbXBvbmVudDxcclxuICAgIENvbXBvbmVudCBleHRlbmRzIGFueSB8IEJhc2VEZXRhaWxDb21wb25lbnQ8RW50aXR5PixcclxuICAgIEVudGl0eSBleHRlbmRzIHsgaWQ6IHN0cmluZzsgdXBkYXRlZEF0Pzogc3RyaW5nIH0sXHJcbiAgICBUIGV4dGVuZHMgRG9jdW1lbnROb2RlIHwgVHlwZWREb2N1bWVudE5vZGU8YW55LCB7IGlkOiBzdHJpbmcgfT4sXHJcbiAgICBGaWVsZCBleHRlbmRzIGtleW9mIFJlc3VsdE9mPFQ+LFxyXG4gICAgUiBleHRlbmRzIEZpZWxkLFxyXG4+KG9wdGlvbnM6IFJlZ2lzdGVyUm91dGVDb21wb25lbnRPcHRpb25zPENvbXBvbmVudCwgRW50aXR5LCBULCBGaWVsZCwgUj4pIHtcclxuICAgIGNvbnN0IHsgcXVlcnksIGVudGl0eUtleSwgdmFyaWFibGVzLCBnZXRCcmVhZGNydW1icywgbG9jYXRpb25JZCwgZGVzY3JpcHRpb24gfSA9IG9wdGlvbnM7XHJcblxyXG4gICAgY29uc3QgYnJlYWRjcnVtYlN1YmplY3QkID0gbmV3IEJlaGF2aW9yU3ViamVjdDxCcmVhZGNydW1iVmFsdWU+KG9wdGlvbnMuYnJlYWRjcnVtYiA/PyAnJyk7XHJcbiAgICBjb25zdCB0aXRsZVN1YmplY3QkID0gbmV3IEJlaGF2aW9yU3ViamVjdDxzdHJpbmcgfCB1bmRlZmluZWQ+KG9wdGlvbnMudGl0bGUpO1xyXG5cclxuICAgIGlmIChnZXRCcmVhZGNydW1icyAhPSBudWxsICYmIChxdWVyeSA9PSBudWxsIHx8IGVudGl0eUtleSA9PSBudWxsKSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoXHJcbiAgICAgICAgICAgIFtcclxuICAgICAgICAgICAgICAgIGBbJHtcclxuICAgICAgICAgICAgICAgICAgICBvcHRpb25zLnBhdGggPz8gJ2N1c3RvbSdcclxuICAgICAgICAgICAgICAgIH0gcm91dGVdIFdoZW4gdXNpbmcgdGhlIFwiZ2V0QnJlYWRjcnVtYnNcIiBvcHRpb24sIHRoZSBcInF1ZXJ5XCIgYW5kIFwiZW50aXR5S2V5XCIgb3B0aW9ucyBtdXN0IGFsc28gYmUgcHJvdmlkZWQuYCxcclxuICAgICAgICAgICAgICAgIGBgLFxyXG4gICAgICAgICAgICAgICAgYEFsdGVybmF0aXZlbHksIHVzZSB0aGUgXCJicmVhZGNydW1iXCIgb3B0aW9uIGluc3RlYWQsIG9yIHVzZSB0aGUgXCJQYWdlTWV0YWRhdGFTZXJ2aWNlXCIgaW5zaWRlIHlvdXIgQW5ndWxhciBjb21wb25lbnRgLFxyXG4gICAgICAgICAgICAgICAgYG9yIHRoZSBcInVzZVBhZ2VNZXRhZGF0YVwiIFJlYWN0IGhvb2sgdG8gc2V0IHRoZSBicmVhZGNydW1iLmAsXHJcbiAgICAgICAgICAgIF0uam9pbignXFxuJyksXHJcbiAgICAgICAgKTtcclxuICAgIH1cclxuXHJcbiAgICBjb25zdCByZXNvbHZlRm46XHJcbiAgICAgICAgfCBSZXNvbHZlRm48e1xyXG4gICAgICAgICAgICAgIGVudGl0eTogT2JzZXJ2YWJsZTxSZXN1bHRPZjxUPltGaWVsZF0gfCBudWxsPjtcclxuICAgICAgICAgICAgICByZXN1bHQ/OiBSZXN1bHRPZjxUPjtcclxuICAgICAgICAgIH0+XHJcbiAgICAgICAgfCB1bmRlZmluZWQgPVxyXG4gICAgICAgIHF1ZXJ5ICYmIGVudGl0eUtleVxyXG4gICAgICAgICAgICA/IGNyZWF0ZUJhc2VEZXRhaWxSZXNvbHZlRm4oe1xyXG4gICAgICAgICAgICAgICAgICBxdWVyeSxcclxuICAgICAgICAgICAgICAgICAgZW50aXR5S2V5LFxyXG4gICAgICAgICAgICAgICAgICB2YXJpYWJsZXMsXHJcbiAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgOiB1bmRlZmluZWQ7XHJcblxyXG4gICAgcmV0dXJuIHtcclxuICAgICAgICBwYXRoOiBvcHRpb25zLnBhdGggPz8gJycsXHJcbiAgICAgICAgcHJvdmlkZXJzOiBbXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIHByb3ZpZGU6IFJPVVRFX0NPTVBPTkVOVF9PUFRJT05TLFxyXG4gICAgICAgICAgICAgICAgdXNlVmFsdWU6IHtcclxuICAgICAgICAgICAgICAgICAgICBjb21wb25lbnQ6IG9wdGlvbnMuY29tcG9uZW50LFxyXG4gICAgICAgICAgICAgICAgICAgIHRpdGxlJDogdGl0bGVTdWJqZWN0JCxcclxuICAgICAgICAgICAgICAgICAgICBicmVhZGNydW1iJDogYnJlYWRjcnVtYlN1YmplY3QkLFxyXG4gICAgICAgICAgICAgICAgfSBzYXRpc2ZpZXMgUm91dGVDb21wb25lbnRPcHRpb25zLFxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAuLi4ob3B0aW9ucy5yb3V0ZUNvbmZpZz8ucHJvdmlkZXJzID8/IFtdKSxcclxuICAgICAgICBdLFxyXG4gICAgICAgIC4uLihvcHRpb25zLnJvdXRlQ29uZmlnID8/IHt9KSxcclxuICAgICAgICByZXNvbHZlOiB7IC4uLihyZXNvbHZlRm4gPyB7IGRldGFpbDogcmVzb2x2ZUZuIH0gOiB7fSksIC4uLihvcHRpb25zLnJvdXRlQ29uZmlnPy5yZXNvbHZlID8/IHt9KSB9LFxyXG4gICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgICAgbG9jYXRpb25JZCxcclxuICAgICAgICAgICAgZGVzY3JpcHRpb24sXHJcbiAgICAgICAgICAgIGJyZWFkY3J1bWI6IGJyZWFkY3J1bWJTdWJqZWN0JCxcclxuICAgICAgICAgICAgLi4uKG9wdGlvbnMucm91dGVDb25maWc/LmRhdGEgPz8ge30pLFxyXG4gICAgICAgICAgICAuLi4oZ2V0QnJlYWRjcnVtYnMgJiYgcXVlcnkgJiYgZW50aXR5S2V5XHJcbiAgICAgICAgICAgICAgICA/IHtcclxuICAgICAgICAgICAgICAgICAgICAgIGJyZWFkY3J1bWI6IGRhdGEgPT5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICBkYXRhLmRldGFpbC5lbnRpdHkucGlwZShtYXAoKGVudGl0eTogYW55KSA9PiBnZXRCcmVhZGNydW1icyhlbnRpdHkpKSksXHJcbiAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIDoge30pLFxyXG4gICAgICAgICAgICAuLi4ob3B0aW9ucy5yb3V0ZUNvbmZpZz8uZGF0YSA/PyB7fSksXHJcbiAgICAgICAgfSxcclxuICAgICAgICBjb21wb25lbnQ6IEFuZ3VsYXJSb3V0ZUNvbXBvbmVudCxcclxuICAgIH0gc2F0aXNmaWVzIFJvdXRlO1xyXG59XHJcbiJdfQ==