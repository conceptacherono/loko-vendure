import { Injectable } from '@angular/core';
import { from, Observable } from 'rxjs';
import { mergeMap } from 'rxjs/operators';
import { ModalDialogComponent } from '../../shared/components/modal-dialog/modal-dialog.component';
import { SimpleDialogComponent } from '../../shared/components/simple-dialog/simple-dialog.component';
import * as i0 from "@angular/core";
import * as i1 from "../overlay-host/overlay-host.service";
/**
 * @description
 * This service is responsible for instantiating a ModalDialog component and
 * embedding the specified component within.
 *
 * @docsCategory services
 * @docsPage ModalService
 * @docsWeight 0
 */
export class ModalService {
    constructor(overlayHostService) {
        this.overlayHostService = overlayHostService;
    }
    /**
     * @description
     * Create a modal from a component. The component must implement the {@link Dialog} interface.
     * Additionally, the component should include templates for the title and the buttons to be
     * displayed in the modal dialog. See example:
     *
     * @example
     * ```ts
     * class MyDialog implements Dialog {
     *  resolveWith: (result?: any) => void;
     *
     *  okay() {
     *    doSomeWork().subscribe(result => {
     *      this.resolveWith(result);
     *    })
     *  }
     *
     *  cancel() {
     *    this.resolveWith(false);
     *  }
     * }
     * ```
     *
     * @example
     * ```html
     * <ng-template vdrDialogTitle>Title of the modal</ng-template>
     *
     * <p>
     *   My Content
     * </p>
     *
     * <ng-template vdrDialogButtons>
     *   <button type="button"
     *           class="btn"
     *           (click)="cancel()">Cancel</button>
     *   <button type="button"
     *           class="btn btn-primary"
     *           (click)="okay()">Okay</button>
     * </ng-template>
     * ```
     */
    fromComponent(component, options) {
        return from(this.overlayHostService.getHostView()).pipe(mergeMap(hostView => {
            const modalComponentRef = hostView.createComponent(ModalDialogComponent);
            const modalInstance = modalComponentRef.instance;
            modalInstance.childComponentType = component;
            modalInstance.options = options;
            return new Observable(subscriber => {
                modalInstance.closeModal = (result) => {
                    modalComponentRef.destroy();
                    subscriber.next(result);
                    subscriber.complete();
                };
            });
        }));
    }
    /**
     * @description
     * Displays a modal dialog with the provided title, body and buttons.
     */
    dialog(config) {
        return this.fromComponent(SimpleDialogComponent, {
            locals: config,
            size: config.size,
        });
    }
    static { this.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "17.2.4", ngImport: i0, type: ModalService, deps: [{ token: i1.OverlayHostService }], target: i0.ɵɵFactoryTarget.Injectable }); }
    static { this.ɵprov = i0.ɵɵngDeclareInjectable({ minVersion: "12.0.0", version: "17.2.4", ngImport: i0, type: ModalService, providedIn: 'root' }); }
}
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "17.2.4", ngImport: i0, type: ModalService, decorators: [{
            type: Injectable,
            args: [{
                    providedIn: 'root',
                }]
        }], ctorParameters: () => [{ type: i1.OverlayHostService }] });
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibW9kYWwuc2VydmljZS5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uLy4uL3NyYy9saWIvY29yZS9zcmMvcHJvdmlkZXJzL21vZGFsL21vZGFsLnNlcnZpY2UudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsT0FBTyxFQUFFLFVBQVUsRUFBRSxNQUFNLGVBQWUsQ0FBQztBQUUzQyxPQUFPLEVBQUUsSUFBSSxFQUFFLFVBQVUsRUFBRSxNQUFNLE1BQU0sQ0FBQztBQUN4QyxPQUFPLEVBQUUsUUFBUSxFQUFFLE1BQU0sZ0JBQWdCLENBQUM7QUFFMUMsT0FBTyxFQUFFLG9CQUFvQixFQUFFLE1BQU0sNkRBQTZELENBQUM7QUFDbkcsT0FBTyxFQUFFLHFCQUFxQixFQUFFLE1BQU0sK0RBQStELENBQUM7OztBQUt0Rzs7Ozs7Ozs7R0FRRztBQUlILE1BQU0sT0FBTyxZQUFZO0lBQ3JCLFlBQW9CLGtCQUFzQztRQUF0Qyx1QkFBa0IsR0FBbEIsa0JBQWtCLENBQW9CO0lBQUcsQ0FBQztJQUU5RDs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztPQXdDRztJQUNILGFBQWEsQ0FDVCxTQUFvQyxFQUNwQyxPQUF5QjtRQUV6QixPQUFPLElBQUksQ0FBQyxJQUFJLENBQUMsa0JBQWtCLENBQUMsV0FBVyxFQUFFLENBQUMsQ0FBQyxJQUFJLENBQ25ELFFBQVEsQ0FBQyxRQUFRLENBQUMsRUFBRTtZQUNoQixNQUFNLGlCQUFpQixHQUFHLFFBQVEsQ0FBQyxlQUFlLENBQUMsb0JBQW9CLENBQUMsQ0FBQztZQUN6RSxNQUFNLGFBQWEsR0FBOEIsaUJBQWlCLENBQUMsUUFBUSxDQUFDO1lBQzVFLGFBQWEsQ0FBQyxrQkFBa0IsR0FBRyxTQUFTLENBQUM7WUFDN0MsYUFBYSxDQUFDLE9BQU8sR0FBRyxPQUFPLENBQUM7WUFFaEMsT0FBTyxJQUFJLFVBQVUsQ0FBSSxVQUFVLENBQUMsRUFBRTtnQkFDbEMsYUFBYSxDQUFDLFVBQVUsR0FBRyxDQUFDLE1BQVMsRUFBRSxFQUFFO29CQUNyQyxpQkFBaUIsQ0FBQyxPQUFPLEVBQUUsQ0FBQztvQkFDNUIsVUFBVSxDQUFDLElBQUksQ0FBQyxNQUFNLENBQUMsQ0FBQztvQkFDeEIsVUFBVSxDQUFDLFFBQVEsRUFBRSxDQUFDO2dCQUMxQixDQUFDLENBQUM7WUFDTixDQUFDLENBQUMsQ0FBQztRQUNQLENBQUMsQ0FBQyxDQUNMLENBQUM7SUFDTixDQUFDO0lBRUQ7OztPQUdHO0lBQ0gsTUFBTSxDQUFJLE1BQXVCO1FBQzdCLE9BQU8sSUFBSSxDQUFDLGFBQWEsQ0FBQyxxQkFBcUIsRUFBRTtZQUM3QyxNQUFNLEVBQUUsTUFBTTtZQUNkLElBQUksRUFBRSxNQUFNLENBQUMsSUFBSTtTQUNwQixDQUFDLENBQUM7SUFDUCxDQUFDOzhHQTNFUSxZQUFZO2tIQUFaLFlBQVksY0FGVCxNQUFNOzsyRkFFVCxZQUFZO2tCQUh4QixVQUFVO21CQUFDO29CQUNSLFVBQVUsRUFBRSxNQUFNO2lCQUNyQiIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEluamVjdGFibGUgfSBmcm9tICdAYW5ndWxhci9jb3JlJztcclxuaW1wb3J0IHsgVHlwZSB9IGZyb20gJ0B2ZW5kdXJlL2NvbW1vbi9saWIvc2hhcmVkLXR5cGVzJztcclxuaW1wb3J0IHsgZnJvbSwgT2JzZXJ2YWJsZSB9IGZyb20gJ3J4anMnO1xyXG5pbXBvcnQgeyBtZXJnZU1hcCB9IGZyb20gJ3J4anMvb3BlcmF0b3JzJztcclxuXHJcbmltcG9ydCB7IE1vZGFsRGlhbG9nQ29tcG9uZW50IH0gZnJvbSAnLi4vLi4vc2hhcmVkL2NvbXBvbmVudHMvbW9kYWwtZGlhbG9nL21vZGFsLWRpYWxvZy5jb21wb25lbnQnO1xyXG5pbXBvcnQgeyBTaW1wbGVEaWFsb2dDb21wb25lbnQgfSBmcm9tICcuLi8uLi9zaGFyZWQvY29tcG9uZW50cy9zaW1wbGUtZGlhbG9nL3NpbXBsZS1kaWFsb2cuY29tcG9uZW50JztcclxuaW1wb3J0IHsgT3ZlcmxheUhvc3RTZXJ2aWNlIH0gZnJvbSAnLi4vb3ZlcmxheS1ob3N0L292ZXJsYXktaG9zdC5zZXJ2aWNlJztcclxuXHJcbmltcG9ydCB7IERpYWxvZywgRGlhbG9nQ29uZmlnLCBNb2RhbE9wdGlvbnMgfSBmcm9tICcuL21vZGFsLnR5cGVzJztcclxuXHJcbi8qKlxyXG4gKiBAZGVzY3JpcHRpb25cclxuICogVGhpcyBzZXJ2aWNlIGlzIHJlc3BvbnNpYmxlIGZvciBpbnN0YW50aWF0aW5nIGEgTW9kYWxEaWFsb2cgY29tcG9uZW50IGFuZFxyXG4gKiBlbWJlZGRpbmcgdGhlIHNwZWNpZmllZCBjb21wb25lbnQgd2l0aGluLlxyXG4gKlxyXG4gKiBAZG9jc0NhdGVnb3J5IHNlcnZpY2VzXHJcbiAqIEBkb2NzUGFnZSBNb2RhbFNlcnZpY2VcclxuICogQGRvY3NXZWlnaHQgMFxyXG4gKi9cclxuQEluamVjdGFibGUoe1xyXG4gICAgcHJvdmlkZWRJbjogJ3Jvb3QnLFxyXG59KVxyXG5leHBvcnQgY2xhc3MgTW9kYWxTZXJ2aWNlIHtcclxuICAgIGNvbnN0cnVjdG9yKHByaXZhdGUgb3ZlcmxheUhvc3RTZXJ2aWNlOiBPdmVybGF5SG9zdFNlcnZpY2UpIHt9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBAZGVzY3JpcHRpb25cclxuICAgICAqIENyZWF0ZSBhIG1vZGFsIGZyb20gYSBjb21wb25lbnQuIFRoZSBjb21wb25lbnQgbXVzdCBpbXBsZW1lbnQgdGhlIHtAbGluayBEaWFsb2d9IGludGVyZmFjZS5cclxuICAgICAqIEFkZGl0aW9uYWxseSwgdGhlIGNvbXBvbmVudCBzaG91bGQgaW5jbHVkZSB0ZW1wbGF0ZXMgZm9yIHRoZSB0aXRsZSBhbmQgdGhlIGJ1dHRvbnMgdG8gYmVcclxuICAgICAqIGRpc3BsYXllZCBpbiB0aGUgbW9kYWwgZGlhbG9nLiBTZWUgZXhhbXBsZTpcclxuICAgICAqXHJcbiAgICAgKiBAZXhhbXBsZVxyXG4gICAgICogYGBgdHNcclxuICAgICAqIGNsYXNzIE15RGlhbG9nIGltcGxlbWVudHMgRGlhbG9nIHtcclxuICAgICAqICByZXNvbHZlV2l0aDogKHJlc3VsdD86IGFueSkgPT4gdm9pZDtcclxuICAgICAqXHJcbiAgICAgKiAgb2theSgpIHtcclxuICAgICAqICAgIGRvU29tZVdvcmsoKS5zdWJzY3JpYmUocmVzdWx0ID0+IHtcclxuICAgICAqICAgICAgdGhpcy5yZXNvbHZlV2l0aChyZXN1bHQpO1xyXG4gICAgICogICAgfSlcclxuICAgICAqICB9XHJcbiAgICAgKlxyXG4gICAgICogIGNhbmNlbCgpIHtcclxuICAgICAqICAgIHRoaXMucmVzb2x2ZVdpdGgoZmFsc2UpO1xyXG4gICAgICogIH1cclxuICAgICAqIH1cclxuICAgICAqIGBgYFxyXG4gICAgICpcclxuICAgICAqIEBleGFtcGxlXHJcbiAgICAgKiBgYGBodG1sXHJcbiAgICAgKiA8bmctdGVtcGxhdGUgdmRyRGlhbG9nVGl0bGU+VGl0bGUgb2YgdGhlIG1vZGFsPC9uZy10ZW1wbGF0ZT5cclxuICAgICAqXHJcbiAgICAgKiA8cD5cclxuICAgICAqICAgTXkgQ29udGVudFxyXG4gICAgICogPC9wPlxyXG4gICAgICpcclxuICAgICAqIDxuZy10ZW1wbGF0ZSB2ZHJEaWFsb2dCdXR0b25zPlxyXG4gICAgICogICA8YnV0dG9uIHR5cGU9XCJidXR0b25cIlxyXG4gICAgICogICAgICAgICAgIGNsYXNzPVwiYnRuXCJcclxuICAgICAqICAgICAgICAgICAoY2xpY2spPVwiY2FuY2VsKClcIj5DYW5jZWw8L2J1dHRvbj5cclxuICAgICAqICAgPGJ1dHRvbiB0eXBlPVwiYnV0dG9uXCJcclxuICAgICAqICAgICAgICAgICBjbGFzcz1cImJ0biBidG4tcHJpbWFyeVwiXHJcbiAgICAgKiAgICAgICAgICAgKGNsaWNrKT1cIm9rYXkoKVwiPk9rYXk8L2J1dHRvbj5cclxuICAgICAqIDwvbmctdGVtcGxhdGU+XHJcbiAgICAgKiBgYGBcclxuICAgICAqL1xyXG4gICAgZnJvbUNvbXBvbmVudDxUIGV4dGVuZHMgRGlhbG9nPGFueT4sIFI+KFxyXG4gICAgICAgIGNvbXBvbmVudDogVHlwZTxUPiAmIFR5cGU8RGlhbG9nPFI+PixcclxuICAgICAgICBvcHRpb25zPzogTW9kYWxPcHRpb25zPFQ+LFxyXG4gICAgKTogT2JzZXJ2YWJsZTxSIHwgdW5kZWZpbmVkPiB7XHJcbiAgICAgICAgcmV0dXJuIGZyb20odGhpcy5vdmVybGF5SG9zdFNlcnZpY2UuZ2V0SG9zdFZpZXcoKSkucGlwZShcclxuICAgICAgICAgICAgbWVyZ2VNYXAoaG9zdFZpZXcgPT4ge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgbW9kYWxDb21wb25lbnRSZWYgPSBob3N0Vmlldy5jcmVhdGVDb21wb25lbnQoTW9kYWxEaWFsb2dDb21wb25lbnQpO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgbW9kYWxJbnN0YW5jZTogTW9kYWxEaWFsb2dDb21wb25lbnQ8YW55PiA9IG1vZGFsQ29tcG9uZW50UmVmLmluc3RhbmNlO1xyXG4gICAgICAgICAgICAgICAgbW9kYWxJbnN0YW5jZS5jaGlsZENvbXBvbmVudFR5cGUgPSBjb21wb25lbnQ7XHJcbiAgICAgICAgICAgICAgICBtb2RhbEluc3RhbmNlLm9wdGlvbnMgPSBvcHRpb25zO1xyXG5cclxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgT2JzZXJ2YWJsZTxSPihzdWJzY3JpYmVyID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBtb2RhbEluc3RhbmNlLmNsb3NlTW9kYWwgPSAocmVzdWx0OiBSKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG1vZGFsQ29tcG9uZW50UmVmLmRlc3Ryb3koKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgc3Vic2NyaWJlci5uZXh0KHJlc3VsdCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHN1YnNjcmliZXIuY29tcGxldGUoKTtcclxuICAgICAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH0pLFxyXG4gICAgICAgICk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBAZGVzY3JpcHRpb25cclxuICAgICAqIERpc3BsYXlzIGEgbW9kYWwgZGlhbG9nIHdpdGggdGhlIHByb3ZpZGVkIHRpdGxlLCBib2R5IGFuZCBidXR0b25zLlxyXG4gICAgICovXHJcbiAgICBkaWFsb2c8VD4oY29uZmlnOiBEaWFsb2dDb25maWc8VD4pOiBPYnNlcnZhYmxlPFQgfCB1bmRlZmluZWQ+IHtcclxuICAgICAgICByZXR1cm4gdGhpcy5mcm9tQ29tcG9uZW50KFNpbXBsZURpYWxvZ0NvbXBvbmVudCwge1xyXG4gICAgICAgICAgICBsb2NhbHM6IGNvbmZpZyxcclxuICAgICAgICAgICAgc2l6ZTogY29uZmlnLnNpemUsXHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcbn1cclxuIl19