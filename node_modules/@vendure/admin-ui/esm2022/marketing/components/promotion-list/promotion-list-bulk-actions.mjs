import { marker as _ } from '@biesbjerg/ngx-translate-extract-marker';
import { AssignPromotionsToChannelDocument, createBulkAssignToChannelAction, createBulkDeleteAction, createBulkRemoveFromChannelAction, DuplicateEntityDialogComponent, ModalService, Permission, RemovePromotionsFromChannelDocument, } from '@vendure/admin-ui/core';
import { gql } from 'apollo-angular';
import { map } from 'rxjs/operators';
const ASSIGN_PROMOTIONS_TO_CHANNEL = gql `
    mutation AssignPromotionsToChannel($input: AssignPromotionsToChannelInput!) {
        assignPromotionsToChannel(input: $input) {
            id
            name
        }
    }
`;
const REMOVE_PROMOTIONS_FROM_CHANNEL = gql `
    mutation RemovePromotionsFromChannel($input: RemovePromotionsFromChannelInput!) {
        removePromotionsFromChannel(input: $input) {
            id
            name
        }
    }
`;
export const deletePromotionsBulkAction = createBulkDeleteAction({
    location: 'promotion-list',
    requiresPermission: Permission.DeletePromotion,
    getItemName: item => item.name,
    bulkDelete: (dataService, ids) => dataService.promotion.deletePromotions(ids).pipe(map(res => res.deletePromotions)),
});
export const assignPromotionsToChannelBulkAction = createBulkAssignToChannelAction({
    location: 'promotion-list',
    requiresPermission: Permission.UpdatePromotion,
    getItemName: item => item.name,
    bulkAssignToChannel: (dataService, promotionIds, channelIds) => {
        return channelIds.map(channelId => dataService
            .mutate(AssignPromotionsToChannelDocument, {
            input: {
                channelId,
                promotionIds,
            },
        })
            .pipe(map(res => res.assignPromotionsToChannel)));
    },
});
export const removePromotionsFromChannelBulkAction = createBulkRemoveFromChannelAction({
    location: 'promotion-list',
    requiresPermission: Permission.DeleteCatalog,
    getItemName: item => item.name,
    bulkRemoveFromChannel: (dataService, promotionIds, channelId) => dataService
        .mutate(RemovePromotionsFromChannelDocument, {
        input: {
            channelId,
            promotionIds,
        },
    })
        .pipe(map(res => res.removePromotionsFromChannel)),
});
export const duplicatePromotionsBulkAction = {
    location: 'promotion-list',
    label: _('common.duplicate'),
    icon: 'copy',
    onClick: ({ injector, selection, hostComponent, clearSelection }) => {
        const modalService = injector.get(ModalService);
        modalService
            .fromComponent((DuplicateEntityDialogComponent), {
            locals: {
                entities: selection,
                entityName: 'Promotion',
                title: _('marketing.duplicate-promotions'),
                getEntityName: entity => entity.name,
            },
        })
            .subscribe(result => {
            if (result) {
                clearSelection();
                hostComponent.refresh();
            }
        });
    },
};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicHJvbW90aW9uLWxpc3QtYnVsay1hY3Rpb25zLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vLi4vc3JjL2xpYi9tYXJrZXRpbmcvc3JjL2NvbXBvbmVudHMvcHJvbW90aW9uLWxpc3QvcHJvbW90aW9uLWxpc3QtYnVsay1hY3Rpb25zLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLE9BQU8sRUFBRSxNQUFNLElBQUksQ0FBQyxFQUFFLE1BQU0seUNBQXlDLENBQUM7QUFDdEUsT0FBTyxFQUNILGlDQUFpQyxFQUVqQywrQkFBK0IsRUFDL0Isc0JBQXNCLEVBQ3RCLGlDQUFpQyxFQUNqQyw4QkFBOEIsRUFHOUIsWUFBWSxFQUNaLFVBQVUsRUFDVixtQ0FBbUMsR0FDdEMsTUFBTSx3QkFBd0IsQ0FBQztBQUNoQyxPQUFPLEVBQUUsR0FBRyxFQUFFLE1BQU0sZ0JBQWdCLENBQUM7QUFDckMsT0FBTyxFQUFFLEdBQUcsRUFBRSxNQUFNLGdCQUFnQixDQUFDO0FBR3JDLE1BQU0sNEJBQTRCLEdBQUcsR0FBRyxDQUFBOzs7Ozs7O0NBT3ZDLENBQUM7QUFFRixNQUFNLDhCQUE4QixHQUFHLEdBQUcsQ0FBQTs7Ozs7OztDQU96QyxDQUFDO0FBRUYsTUFBTSxDQUFDLE1BQU0sMEJBQTBCLEdBQUcsc0JBQXNCLENBQzVEO0lBQ0ksUUFBUSxFQUFFLGdCQUFnQjtJQUMxQixrQkFBa0IsRUFBRSxVQUFVLENBQUMsZUFBZTtJQUM5QyxXQUFXLEVBQUUsSUFBSSxDQUFDLEVBQUUsQ0FBQyxJQUFJLENBQUMsSUFBSTtJQUM5QixVQUFVLEVBQUUsQ0FBQyxXQUFXLEVBQUUsR0FBRyxFQUFFLEVBQUUsQ0FDN0IsV0FBVyxDQUFDLFNBQVMsQ0FBQyxnQkFBZ0IsQ0FBQyxHQUFHLENBQUMsQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDLEdBQUcsQ0FBQyxFQUFFLENBQUMsR0FBRyxDQUFDLGdCQUFnQixDQUFDLENBQUM7Q0FDekYsQ0FDSixDQUFDO0FBRUYsTUFBTSxDQUFDLE1BQU0sbUNBQW1DLEdBQUcsK0JBQStCLENBRWhGO0lBQ0UsUUFBUSxFQUFFLGdCQUFnQjtJQUMxQixrQkFBa0IsRUFBRSxVQUFVLENBQUMsZUFBZTtJQUM5QyxXQUFXLEVBQUUsSUFBSSxDQUFDLEVBQUUsQ0FBQyxJQUFJLENBQUMsSUFBSTtJQUM5QixtQkFBbUIsRUFBRSxDQUFDLFdBQVcsRUFBRSxZQUFZLEVBQUUsVUFBVSxFQUFFLEVBQUU7UUFDM0QsT0FBTyxVQUFVLENBQUMsR0FBRyxDQUFDLFNBQVMsQ0FBQyxFQUFFLENBQzlCLFdBQVc7YUFDTixNQUFNLENBQUMsaUNBQWlDLEVBQUU7WUFDdkMsS0FBSyxFQUFFO2dCQUNILFNBQVM7Z0JBQ1QsWUFBWTthQUNmO1NBQ0osQ0FBQzthQUNELElBQUksQ0FBQyxHQUFHLENBQUMsR0FBRyxDQUFDLEVBQUUsQ0FBQyxHQUFHLENBQUMseUJBQXlCLENBQUMsQ0FBQyxDQUN2RCxDQUFDO0lBQ04sQ0FBQztDQUNKLENBQUMsQ0FBQztBQUVILE1BQU0sQ0FBQyxNQUFNLHFDQUFxQyxHQUFHLGlDQUFpQyxDQUVwRjtJQUNFLFFBQVEsRUFBRSxnQkFBZ0I7SUFDMUIsa0JBQWtCLEVBQUUsVUFBVSxDQUFDLGFBQWE7SUFDNUMsV0FBVyxFQUFFLElBQUksQ0FBQyxFQUFFLENBQUMsSUFBSSxDQUFDLElBQUk7SUFDOUIscUJBQXFCLEVBQUUsQ0FBQyxXQUFXLEVBQUUsWUFBWSxFQUFFLFNBQVMsRUFBRSxFQUFFLENBQzVELFdBQVc7U0FDTixNQUFNLENBQUMsbUNBQW1DLEVBQUU7UUFDekMsS0FBSyxFQUFFO1lBQ0gsU0FBUztZQUNULFlBQVk7U0FDZjtLQUNKLENBQUM7U0FDRCxJQUFJLENBQUMsR0FBRyxDQUFDLEdBQUcsQ0FBQyxFQUFFLENBQUMsR0FBRyxDQUFDLDJCQUEyQixDQUFDLENBQUM7Q0FDN0QsQ0FBQyxDQUFDO0FBRUgsTUFBTSxDQUFDLE1BQU0sNkJBQTZCLEdBR3RDO0lBQ0EsUUFBUSxFQUFFLGdCQUFnQjtJQUMxQixLQUFLLEVBQUUsQ0FBQyxDQUFDLGtCQUFrQixDQUFDO0lBQzVCLElBQUksRUFBRSxNQUFNO0lBQ1osT0FBTyxFQUFFLENBQUMsRUFBRSxRQUFRLEVBQUUsU0FBUyxFQUFFLGFBQWEsRUFBRSxjQUFjLEVBQUUsRUFBRSxFQUFFO1FBQ2hFLE1BQU0sWUFBWSxHQUFHLFFBQVEsQ0FBQyxHQUFHLENBQUMsWUFBWSxDQUFDLENBQUM7UUFDaEQsWUFBWTthQUNQLGFBQWEsQ0FBQyxDQUFBLDhCQUEyRSxDQUFBLEVBQUU7WUFDeEYsTUFBTSxFQUFFO2dCQUNKLFFBQVEsRUFBRSxTQUFTO2dCQUNuQixVQUFVLEVBQUUsV0FBVztnQkFDdkIsS0FBSyxFQUFFLENBQUMsQ0FBQyxnQ0FBZ0MsQ0FBQztnQkFDMUMsYUFBYSxFQUFFLE1BQU0sQ0FBQyxFQUFFLENBQUMsTUFBTSxDQUFDLElBQUk7YUFDdkM7U0FDSixDQUFDO2FBQ0QsU0FBUyxDQUFDLE1BQU0sQ0FBQyxFQUFFO1lBQ2hCLElBQUksTUFBTSxFQUFFLENBQUM7Z0JBQ1QsY0FBYyxFQUFFLENBQUM7Z0JBQ2pCLGFBQWEsQ0FBQyxPQUFPLEVBQUUsQ0FBQztZQUM1QixDQUFDO1FBQ0wsQ0FBQyxDQUFDLENBQUM7SUFDWCxDQUFDO0NBQ0osQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IG1hcmtlciBhcyBfIH0gZnJvbSAnQGJpZXNiamVyZy9uZ3gtdHJhbnNsYXRlLWV4dHJhY3QtbWFya2VyJztcclxuaW1wb3J0IHtcclxuICAgIEFzc2lnblByb21vdGlvbnNUb0NoYW5uZWxEb2N1bWVudCxcclxuICAgIEJ1bGtBY3Rpb24sXHJcbiAgICBjcmVhdGVCdWxrQXNzaWduVG9DaGFubmVsQWN0aW9uLFxyXG4gICAgY3JlYXRlQnVsa0RlbGV0ZUFjdGlvbixcclxuICAgIGNyZWF0ZUJ1bGtSZW1vdmVGcm9tQ2hhbm5lbEFjdGlvbixcclxuICAgIER1cGxpY2F0ZUVudGl0eURpYWxvZ0NvbXBvbmVudCxcclxuICAgIEdldFByb21vdGlvbkxpc3RRdWVyeSxcclxuICAgIEl0ZW1PZixcclxuICAgIE1vZGFsU2VydmljZSxcclxuICAgIFBlcm1pc3Npb24sXHJcbiAgICBSZW1vdmVQcm9tb3Rpb25zRnJvbUNoYW5uZWxEb2N1bWVudCxcclxufSBmcm9tICdAdmVuZHVyZS9hZG1pbi11aS9jb3JlJztcclxuaW1wb3J0IHsgZ3FsIH0gZnJvbSAnYXBvbGxvLWFuZ3VsYXInO1xyXG5pbXBvcnQgeyBtYXAgfSBmcm9tICdyeGpzL29wZXJhdG9ycyc7XHJcbmltcG9ydCB7IFByb21vdGlvbkxpc3RDb21wb25lbnQgfSBmcm9tICcuL3Byb21vdGlvbi1saXN0LmNvbXBvbmVudCc7XHJcblxyXG5jb25zdCBBU1NJR05fUFJPTU9USU9OU19UT19DSEFOTkVMID0gZ3FsYFxyXG4gICAgbXV0YXRpb24gQXNzaWduUHJvbW90aW9uc1RvQ2hhbm5lbCgkaW5wdXQ6IEFzc2lnblByb21vdGlvbnNUb0NoYW5uZWxJbnB1dCEpIHtcclxuICAgICAgICBhc3NpZ25Qcm9tb3Rpb25zVG9DaGFubmVsKGlucHV0OiAkaW5wdXQpIHtcclxuICAgICAgICAgICAgaWRcclxuICAgICAgICAgICAgbmFtZVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuYDtcclxuXHJcbmNvbnN0IFJFTU9WRV9QUk9NT1RJT05TX0ZST01fQ0hBTk5FTCA9IGdxbGBcclxuICAgIG11dGF0aW9uIFJlbW92ZVByb21vdGlvbnNGcm9tQ2hhbm5lbCgkaW5wdXQ6IFJlbW92ZVByb21vdGlvbnNGcm9tQ2hhbm5lbElucHV0ISkge1xyXG4gICAgICAgIHJlbW92ZVByb21vdGlvbnNGcm9tQ2hhbm5lbChpbnB1dDogJGlucHV0KSB7XHJcbiAgICAgICAgICAgIGlkXHJcbiAgICAgICAgICAgIG5hbWVcclxuICAgICAgICB9XHJcbiAgICB9XHJcbmA7XHJcblxyXG5leHBvcnQgY29uc3QgZGVsZXRlUHJvbW90aW9uc0J1bGtBY3Rpb24gPSBjcmVhdGVCdWxrRGVsZXRlQWN0aW9uPEl0ZW1PZjxHZXRQcm9tb3Rpb25MaXN0UXVlcnksICdwcm9tb3Rpb25zJz4+KFxyXG4gICAge1xyXG4gICAgICAgIGxvY2F0aW9uOiAncHJvbW90aW9uLWxpc3QnLFxyXG4gICAgICAgIHJlcXVpcmVzUGVybWlzc2lvbjogUGVybWlzc2lvbi5EZWxldGVQcm9tb3Rpb24sXHJcbiAgICAgICAgZ2V0SXRlbU5hbWU6IGl0ZW0gPT4gaXRlbS5uYW1lLFxyXG4gICAgICAgIGJ1bGtEZWxldGU6IChkYXRhU2VydmljZSwgaWRzKSA9PlxyXG4gICAgICAgICAgICBkYXRhU2VydmljZS5wcm9tb3Rpb24uZGVsZXRlUHJvbW90aW9ucyhpZHMpLnBpcGUobWFwKHJlcyA9PiByZXMuZGVsZXRlUHJvbW90aW9ucykpLFxyXG4gICAgfSxcclxuKTtcclxuXHJcbmV4cG9ydCBjb25zdCBhc3NpZ25Qcm9tb3Rpb25zVG9DaGFubmVsQnVsa0FjdGlvbiA9IGNyZWF0ZUJ1bGtBc3NpZ25Ub0NoYW5uZWxBY3Rpb248XHJcbiAgICBJdGVtT2Y8R2V0UHJvbW90aW9uTGlzdFF1ZXJ5LCAncHJvbW90aW9ucyc+XHJcbj4oe1xyXG4gICAgbG9jYXRpb246ICdwcm9tb3Rpb24tbGlzdCcsXHJcbiAgICByZXF1aXJlc1Blcm1pc3Npb246IFBlcm1pc3Npb24uVXBkYXRlUHJvbW90aW9uLFxyXG4gICAgZ2V0SXRlbU5hbWU6IGl0ZW0gPT4gaXRlbS5uYW1lLFxyXG4gICAgYnVsa0Fzc2lnblRvQ2hhbm5lbDogKGRhdGFTZXJ2aWNlLCBwcm9tb3Rpb25JZHMsIGNoYW5uZWxJZHMpID0+IHtcclxuICAgICAgICByZXR1cm4gY2hhbm5lbElkcy5tYXAoY2hhbm5lbElkID0+XHJcbiAgICAgICAgICAgIGRhdGFTZXJ2aWNlXHJcbiAgICAgICAgICAgICAgICAubXV0YXRlKEFzc2lnblByb21vdGlvbnNUb0NoYW5uZWxEb2N1bWVudCwge1xyXG4gICAgICAgICAgICAgICAgICAgIGlucHV0OiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNoYW5uZWxJZCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgcHJvbW90aW9uSWRzLFxyXG4gICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgLnBpcGUobWFwKHJlcyA9PiByZXMuYXNzaWduUHJvbW90aW9uc1RvQ2hhbm5lbCkpLFxyXG4gICAgICAgICk7XHJcbiAgICB9LFxyXG59KTtcclxuXHJcbmV4cG9ydCBjb25zdCByZW1vdmVQcm9tb3Rpb25zRnJvbUNoYW5uZWxCdWxrQWN0aW9uID0gY3JlYXRlQnVsa1JlbW92ZUZyb21DaGFubmVsQWN0aW9uPFxyXG4gICAgSXRlbU9mPEdldFByb21vdGlvbkxpc3RRdWVyeSwgJ3Byb21vdGlvbnMnPlxyXG4+KHtcclxuICAgIGxvY2F0aW9uOiAncHJvbW90aW9uLWxpc3QnLFxyXG4gICAgcmVxdWlyZXNQZXJtaXNzaW9uOiBQZXJtaXNzaW9uLkRlbGV0ZUNhdGFsb2csXHJcbiAgICBnZXRJdGVtTmFtZTogaXRlbSA9PiBpdGVtLm5hbWUsXHJcbiAgICBidWxrUmVtb3ZlRnJvbUNoYW5uZWw6IChkYXRhU2VydmljZSwgcHJvbW90aW9uSWRzLCBjaGFubmVsSWQpID0+XHJcbiAgICAgICAgZGF0YVNlcnZpY2VcclxuICAgICAgICAgICAgLm11dGF0ZShSZW1vdmVQcm9tb3Rpb25zRnJvbUNoYW5uZWxEb2N1bWVudCwge1xyXG4gICAgICAgICAgICAgICAgaW5wdXQ6IHtcclxuICAgICAgICAgICAgICAgICAgICBjaGFubmVsSWQsXHJcbiAgICAgICAgICAgICAgICAgICAgcHJvbW90aW9uSWRzLFxyXG4gICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgLnBpcGUobWFwKHJlcyA9PiByZXMucmVtb3ZlUHJvbW90aW9uc0Zyb21DaGFubmVsKSksXHJcbn0pO1xyXG5cclxuZXhwb3J0IGNvbnN0IGR1cGxpY2F0ZVByb21vdGlvbnNCdWxrQWN0aW9uOiBCdWxrQWN0aW9uPFxyXG4gICAgSXRlbU9mPEdldFByb21vdGlvbkxpc3RRdWVyeSwgJ3Byb21vdGlvbnMnPixcclxuICAgIFByb21vdGlvbkxpc3RDb21wb25lbnRcclxuPiA9IHtcclxuICAgIGxvY2F0aW9uOiAncHJvbW90aW9uLWxpc3QnLFxyXG4gICAgbGFiZWw6IF8oJ2NvbW1vbi5kdXBsaWNhdGUnKSxcclxuICAgIGljb246ICdjb3B5JyxcclxuICAgIG9uQ2xpY2s6ICh7IGluamVjdG9yLCBzZWxlY3Rpb24sIGhvc3RDb21wb25lbnQsIGNsZWFyU2VsZWN0aW9uIH0pID0+IHtcclxuICAgICAgICBjb25zdCBtb2RhbFNlcnZpY2UgPSBpbmplY3Rvci5nZXQoTW9kYWxTZXJ2aWNlKTtcclxuICAgICAgICBtb2RhbFNlcnZpY2VcclxuICAgICAgICAgICAgLmZyb21Db21wb25lbnQoRHVwbGljYXRlRW50aXR5RGlhbG9nQ29tcG9uZW50PEl0ZW1PZjxHZXRQcm9tb3Rpb25MaXN0UXVlcnksICdwcm9tb3Rpb25zJz4+LCB7XHJcbiAgICAgICAgICAgICAgICBsb2NhbHM6IHtcclxuICAgICAgICAgICAgICAgICAgICBlbnRpdGllczogc2VsZWN0aW9uLFxyXG4gICAgICAgICAgICAgICAgICAgIGVudGl0eU5hbWU6ICdQcm9tb3Rpb24nLFxyXG4gICAgICAgICAgICAgICAgICAgIHRpdGxlOiBfKCdtYXJrZXRpbmcuZHVwbGljYXRlLXByb21vdGlvbnMnKSxcclxuICAgICAgICAgICAgICAgICAgICBnZXRFbnRpdHlOYW1lOiBlbnRpdHkgPT4gZW50aXR5Lm5hbWUsXHJcbiAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAuc3Vic2NyaWJlKHJlc3VsdCA9PiB7XHJcbiAgICAgICAgICAgICAgICBpZiAocmVzdWx0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY2xlYXJTZWxlY3Rpb24oKTtcclxuICAgICAgICAgICAgICAgICAgICBob3N0Q29tcG9uZW50LnJlZnJlc2goKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICB9LFxyXG59O1xyXG4iXX0=