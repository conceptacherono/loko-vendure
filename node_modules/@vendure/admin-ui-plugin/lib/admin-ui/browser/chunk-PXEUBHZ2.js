import{Ab as me,Ae as Ie,Ba as P,Bd as N,Ca as l,Ce as Se,Da as h,De as Ee,Dg as Fe,Ea as u,Ee as Te,Eg as Je,Fa as L,Fe as je,Ff as Le,Ge as Pe,Hd as he,Jf as De,K as W,La as ie,Le as ke,Lg as Me,Na as ne,Nf as F,Of as J,P as z,Pf as M,Qa as a,Qf as R,Ra as r,Re as Be,Sa as oe,T as X,Tg as Re,U as Z,Ua as k,Wa as ae,Ya as re,Za as x,Zf as we,_ as i,a as G,aa as C,ae as I,ca as y,ce as ve,da as K,db as D,dd as se,de as _e,eb as pe,ee as be,fd as ce,fg as Ne,ga as ee,ha as f,hb as le,hd as de,ia as B,if as S,ja as p,jd as ue,ld as w,ma as n,n as V,na as o,ng as A,oa as d,og as O,pa as T,qa as j,qg as q,s as Q,sa as te,sg as H,ta as b,td as fe,u as Y,ua as g,ub as v,wd as ge,xe as Ce,ye,ze as xe}from"./chunk-KV5QNU55.js";var tt=(e,m)=>({"is-success":e,"is-danger":m});function it(e,m){e&1&&(T(0),l(1),a(2,"translate"),j()),e&2&&(i(),u(" ",r(2,1,"system.health-all-systems-up")," "))}function nt(e,m){e&1&&(l(0),a(1,"translate")),e&2&&u(" ",r(1,1,"system.health-error")," ")}function ot(e,m){if(e&1&&(n(0,"div",9)(1,"div",10),d(2,"clr-icon",11),o(),n(3,"div",12),f(4,it,3,3,"ng-container",13)(5,nt,2,3,"ng-template",null,0,k),n(7,"div",14),l(8),a(9,"translate"),a(10,"async"),a(11,"localeDate"),o()()()),e&2){let t=m.ngIf,s=P(6),c=g();i(2),p("ngClass",ne(13,tt,t==="ok",t!=="ok")),B("shape",t==="ok"?"check-circle":"exclamation-circle"),i(2),p("ngIf",t==="ok")("ngIfElse",s),i(4),L(" ",r(9,6,"system.health-last-checked"),": ",oe(11,10,r(10,8,c.healthCheckService.lastCheck$),"mediumTime")," ")}}function at(e,m){e&1&&(T(0),d(1,"clr-icon",17),l(2),a(3,"translate"),j()),e&2&&(i(2),u(" ",r(3,1,"system.health-status-up")," "))}function rt(e,m){e&1&&(d(0,"clr-icon",18),l(1),a(2,"translate")),e&2&&(i(),u(" ",r(2,1,"system.health-status-down")," "))}function pt(e,m){if(e&1&&(n(0,"tr")(1,"td",15),l(2),o(),n(3,"td",15)(4,"vdr-chip",16),f(5,at,4,3,"ng-container",13)(6,rt,3,3,"ng-template",null,1,k),o()(),n(8,"td",15),l(9),o()()),e&2){let t=m.$implicit,s=P(7);i(2),h(t.key),i(2),p("colorType",t.result.status==="up"?"success":"error"),i(),p("ngIf",t.result.status==="up")("ngIfElse",s),i(4),h(t.result.message)}}var He=(()=>{class e{constructor(t){this.healthCheckService=t}static{this.\u0275fac=function(s){return new(s||e)(C(Be))}}static{this.\u0275cmp=y({type:e,selectors:[["vdr-health-check"]],standalone:!1,decls:30,vars:18,consts:[["error",""],["down",""],["class","system-status-header",4,"ngIf"],["locationId","system-status"],[1,"btn","btn-secondary",3,"click"],["shape","refresh"],[1,"table"],[1,"left"],[4,"ngFor","ngForOf"],[1,"system-status-header"],[1,"status-icon"],["size","48",3,"ngClass"],[1,"status-detail"],[4,"ngIf","ngIfElse"],[1,"last-checked"],[1,"align-middle","left"],[3,"colorType"],["shape","check-circle"],["shape","exclamation-circle"]],template:function(s,c){s&1&&(n(0,"vdr-page-header"),d(1,"vdr-page-title"),o(),n(2,"vdr-page-body")(3,"vdr-page-block")(4,"vdr-action-bar")(5,"vdr-ab-left"),f(6,ot,12,16,"div",2),a(7,"async"),o(),n(8,"vdr-ab-right"),d(9,"vdr-action-bar-items",3),n(10,"button",4),b("click",function(){return c.healthCheckService.refresh()}),d(11,"clr-icon",5),l(12),a(13,"translate"),o()()()(),n(14,"vdr-page-block")(15,"table",6)(16,"thead")(17,"tr")(18,"th",7),l(19),a(20,"translate"),o(),n(21,"th",7),l(22),a(23,"translate"),o(),n(24,"th",7),l(25),a(26,"translate"),o()()(),n(27,"tbody"),f(28,pt,10,5,"tr",8),a(29,"async"),o()()()()),s&2&&(i(6),p("ngIf",r(7,6,c.healthCheckService.status$)),i(6),u(" ",r(13,8,"system.health-refresh")," "),i(7),u(" ",r(20,10,"common.name")," "),i(3),u(" ",r(23,12,"system.health-status")," "),i(3),u(" ",r(26,14,"system.health-message")," "),i(3),p("ngForOf",r(29,16,c.healthCheckService.details$)))},dependencies:[I,ae,re,x,R,J,M,S,F,q,H,O,A,D,w,ke],styles:[`.system-status-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:flex-start}.system-status-header[_ngcontent-%COMP%]   .status-detail[_ngcontent-%COMP%]{font-weight:700;margin-inline-end:6px}.system-status-header[_ngcontent-%COMP%]   .last-checked[_ngcontent-%COMP%]{font-weight:400;color:var(--color-grey-500)}
/*# sourceMappingURL=health-check.component-PPMZ7QYE.css.map */`],changeDetection:0})}}return e})();function lt(e,m){if(e&1&&(n(0,"span",3),l(1),a(2,"percent"),o()),e&2){let t=g();i(),u(" ",r(2,1,t.job.progress/100)," ")}}var Ge=(()=>{class e{get iconShape(){switch(this.job.state){case v.COMPLETED:return"check-circle";case v.FAILED:return"exclamation-circle";case v.CANCELLED:return"ban";case v.PENDING:case v.RETRYING:return"hourglass";case v.RUNNING:return"sync"}}get colorType(){switch(this.job.state){case v.COMPLETED:return"success";case v.FAILED:case v.CANCELLED:return"error";case v.PENDING:case v.RETRYING:return"";case v.RUNNING:return"warning"}}static{this.\u0275fac=function(s){return new(s||e)}}static{this.\u0275cmp=y({type:e,selectors:[["vdr-job-state-label"]],inputs:{job:"job"},standalone:!1,decls:5,vars:6,consts:[[3,"colorType"],[1,"mr1"],["class","progress",4,"ngIf"],[1,"progress"]],template:function(s,c){s&1&&(n(0,"vdr-chip",0),d(1,"clr-icon",1),l(2),a(3,"titlecase"),f(4,lt,3,3,"span",2),o()),s&2&&(p("colorType",c.colorType),i(),B("shape",c.iconShape),i(),u(" ",r(3,4,c.job.state)," "),i(2),p("ngIf",c.job.state==="RUNNING"))},dependencies:[I,x,S,le,pe],styles:[`.progress[_ngcontent-%COMP%]{margin-inline-start:3px}clr-icon[_ngcontent-%COMP%]{min-width:12px}
/*# sourceMappingURL=job-state-label.component-DW5FXGFX.css.map */`],changeDetection:0})}}return e})();var st=()=>["DeleteSettings","DeleteSystem"];function ct(e,m){e&1&&(T(0),n(1,"vdr-chip"),l(2),a(3,"translate"),o(),j()),e&2&&(i(2),h(r(3,1,"system.all-job-queues")))}function dt(e,m){if(e&1&&(n(0,"vdr-chip",20),l(1),o()),e&2){let t=g().item;p("colorFrom",t.name),i(),h(t.name)}}function ut(e,m){if(e&1&&f(0,ct,4,3,"ng-container",19)(1,dt,2,2,"ng-template",null,0,k),e&2){let t=m.item,s=P(2);p("ngIf",t.name==="all")("ngIfElse",s)}}function ft(e,m){if(e&1&&l(0),e&2){let t=m.item;u(" ",t.id," ")}}function gt(e,m){if(e&1&&(l(0),a(1,"timeAgo")),e&2){let t=m.item;u(" ",r(1,1,t.createdAt)," ")}}function ht(e,m){if(e&1&&(n(0,"vdr-chip",20),l(1),o()),e&2){let t=m.item;p("colorFrom",t.queueName),i(),h(t.queueName)}}function vt(e,m){if(e&1&&(n(0,"vdr-dropdown")(1,"button",22),a(2,"translate"),d(3,"clr-icon",23),o(),n(4,"vdr-dropdown-menu")(5,"div",24),d(6,"vdr-object-tree",5),o()()()),e&2){let t=g().item;i(),p("title",r(2,2,"system.job-data")),i(5),p("value",t.data)}}function _t(e,m){if(e&1&&f(0,vt,7,4,"vdr-dropdown",21),e&2){let t=m.item;p("ngIf",t.data)}}function bt(e,m){if(e&1&&(n(0,"div",27),l(1),o()),e&2){let t=g().item;i(),u("after ",t.attempts," attempts")}}function Ct(e,m){if(e&1&&(n(0,"div",27),l(1),o()),e&2){let t=g().item;i(),L(" attempting ",t.attempts," of ",t.retries+1," ")}}function yt(e,m){if(e&1&&(d(0,"vdr-job-state-label",25),f(1,bt,2,1,"div",26)(2,Ct,2,2,"div",26)),e&2){let t=m.item;p("job",t),i(),p("ngIf",t.state==="FAILED"),i(),p("ngIf",t.state==="RUNNING"||t.state==="RETRYING")}}function xt(e,m){if(e&1&&(l(0),a(1,"duration")),e&2){let t=m.item;u(" ",r(1,1,t.duration)," ")}}function It(e,m){if(e&1&&(n(0,"vdr-dropdown")(1,"button",28),d(2,"clr-icon",23),l(3),a(4,"translate"),o(),n(5,"vdr-dropdown-menu")(6,"div",24),d(7,"vdr-object-tree",5),o()()()),e&2){let t=g().item;i(3),u(" ",r(4,2,"system.job-result")," "),i(4),p("value",t.result)}}function St(e,m){if(e&1&&(n(0,"vdr-dropdown")(1,"button",29),d(2,"clr-icon",30),l(3),a(4,"translate"),o(),n(5,"vdr-dropdown-menu")(6,"div",24),l(7),o()()()),e&2){let t=g().item;i(3),u(" ",r(4,2,"system.job-error")," "),i(4),u(" ",t.error," ")}}function Et(e,m){if(e&1){let t=te();n(0,"vdr-dropdown")(1,"button",31),d(2,"clr-icon",32),o(),n(3,"vdr-dropdown-menu",33)(4,"button",34),a(5,"hasPermission"),b("click",function(){X(t);let c=g().item,_=g();return Z(_.cancelJob(c.id))}),d(6,"clr-icon",35),l(7),a(8,"translate"),o()()()}e&2&&(i(4),p("disabled",!r(5,2,ie(6,st))),i(3),u(" ",r(8,4,"common.cancel")," "))}function Tt(e,m){if(e&1&&f(0,It,8,4,"vdr-dropdown",21)(1,St,8,4,"vdr-dropdown",21)(2,Et,9,7,"vdr-dropdown",21),e&2){let t=m.item,s=g();p("ngIf",s.hasResult(t)),i(),p("ngIf",t.error),i(),p("ngIf",!t.isSettled&&t.state!=="FAILED")}}var Ue=(()=>{class e extends Re{constructor(t,s,c){super(s,c),this.dataService=t,this.liveUpdate=new N(!0),this.queueFilter=new N("all"),this.stateFilter=new N(""),super.setQueryFn((..._)=>this.dataService.settings.getAllJobs(..._),_=>_.jobs,(_,E)=>{let Ve=this.queueFilter.value==="all"?null:{queueName:{eq:this.queueFilter.value}},$=this.stateFilter.value;return{options:{skip:_,take:E,filter:G(G({},Ve),$?{state:{eq:$}}:{}),sort:{createdAt:me.DESC}}}})}ngOnInit(){super.ngOnInit(),Q(5e3,2e3).pipe(W(this.destroy$),Y(()=>!!this.liveUpdate.value)).subscribe(()=>{this.refresh()}),this.queues$=this.dataService.settings.getJobQueues().mapStream(t=>t.jobQueues).pipe(V(t=>[{name:"all",running:!0},...t]))}hasResult(t){let s=t.result;return s==null?!1:typeof s=="object"?Object.keys(s).length>0:!0}cancelJob(t){this.dataService.settings.cancelJob(t).subscribe(()=>this.refresh())}static{this.\u0275fac=function(s){return new(s||e)(C(se),C(de),C(ce))}}static{this.\u0275cmp=y({type:e,selectors:[["vdr-job-list"]],standalone:!1,features:[ee],decls:67,vars:80,consts:[["others",""],[1,"mr-2"],["type","checkbox","clrCheckbox","","name","live-update",3,"formControl"],["locationId","job-list"],[1,"mr-2",3,"change","addTag","hideSelected","multiple","markFirst","clearable","searchable","formControl"],[3,"value"],["colorType","warning"],["colorType","success"],["colorType","error"],["bindValue","name",3,"change","addTag","items","hideSelected","multiple","markFirst","clearable","searchable","formControl"],["ng-label-tmp","","ng-option-tmp",""],["id","job-list",3,"pageChange","itemsPerPageChange","items","itemsPerPage","totalItems","currentPage"],["id","id",3,"heading"],["id","created-at",3,"heading"],["id","job-queue-name",3,"heading","optional"],["id","job-data",3,"heading","optional"],["id","job-state",3,"heading"],["id","job-duration",3,"heading"],["id","job-result",3,"heading"],[4,"ngIf","ngIfElse"],[3,"colorFrom"],[4,"ngIf"],["vdrDropdownTrigger","",1,"button-small",3,"title"],["shape","details"],[1,"result-detail"],[3,"job"],["class","retry-info",4,"ngIf"],[1,"retry-info"],["vdrDropdownTrigger","",1,"button-small","mr-1"],["vdrDropdownTrigger","",1,"button-small"],["shape","exclamation-circle"],["vdrDropdownTrigger","",1,"icon-button"],["shape","ellipsis-vertical","size","12"],["vdrPosition","bottom-right"],["type","button","vdrDropdownItem","",1,"delete-button",3,"click","disabled"],["shape","ban",1,"is-danger"]],template:function(s,c){s&1&&(n(0,"vdr-page-header"),d(1,"vdr-page-title"),o(),n(2,"vdr-page-body")(3,"vdr-page-block")(4,"vdr-action-bar")(5,"vdr-ab-left")(6,"clr-checkbox-wrapper",1),d(7,"input",2),n(8,"label"),l(9),a(10,"translate"),o()()(),n(11,"vdr-ab-right"),d(12,"vdr-action-bar-items",3),n(13,"ng-select",4),b("change",function(){return c.refresh()}),n(14,"ng-option",5)(15,"vdr-chip"),l(16),a(17,"translate"),o()(),n(18,"ng-option",5)(19,"vdr-chip"),l(20),a(21,"translate"),o()(),n(22,"ng-option",5)(23,"vdr-chip",6),l(24),a(25,"translate"),o()(),n(26,"ng-option",5)(27,"vdr-chip",7),l(28),a(29,"translate"),o()(),n(30,"ng-option",5)(31,"vdr-chip",8),l(32),a(33,"translate"),o()(),n(34,"ng-option",5)(35,"vdr-chip",8),l(36),a(37,"translate"),o()()(),n(38,"ng-select",9),a(39,"async"),b("change",function(){return c.refresh()}),f(40,ut,3,2,"ng-template",10),o()()()(),n(41,"vdr-data-table-2",11),a(42,"async"),a(43,"async"),a(44,"async"),a(45,"async"),b("pageChange",function(E){return c.setPageNumber(E)})("itemsPerPageChange",function(E){return c.setItemsPerPage(E)}),n(46,"vdr-dt2-column",12),a(47,"translate"),f(48,ft,1,1,"ng-template"),o(),n(49,"vdr-dt2-column",13),a(50,"translate"),f(51,gt,2,3,"ng-template"),o(),n(52,"vdr-dt2-column",14),a(53,"translate"),f(54,ht,2,2,"ng-template"),o(),n(55,"vdr-dt2-column",15),a(56,"translate"),f(57,_t,1,1,"ng-template"),o(),n(58,"vdr-dt2-column",16),a(59,"translate"),f(60,yt,3,3,"ng-template"),o(),n(61,"vdr-dt2-column",17),a(62,"translate"),f(63,xt,2,3,"ng-template"),o(),n(64,"vdr-dt2-column",18),a(65,"translate"),f(66,Tt,3,3,"ng-template"),o()()()),s&2&&(i(7),p("formControl",c.liveUpdate),i(2),h(r(10,42,"common.live-update")),i(4),p("addTag",!1)("hideSelected",!0)("multiple",!1)("markFirst",!1)("clearable",!1)("searchable",!1)("formControl",c.stateFilter),i(),p("value",""),i(2),h(r(17,44,"system.job-state-all")),i(2),p("value","PENDING"),i(2),h(r(21,46,"system.job-state-pending")),i(2),p("value","RUNNING"),i(2),h(r(25,48,"system.job-state-running")),i(2),p("value","COMPLETED"),i(2),h(r(29,50,"system.job-state-completed")),i(2),p("value","FAILED"),i(2),h(r(33,52,"system.job-state-failed")),i(2),p("value","CANCELLED"),i(2),h(r(37,54,"system.job-state-cancelled")),i(2),p("addTag",!1)("items",r(39,56,c.queues$))("hideSelected",!0)("multiple",!1)("markFirst",!1)("clearable",!1)("searchable",!1)("formControl",c.queueFilter),i(3),p("items",r(42,58,c.items$))("itemsPerPage",r(43,60,c.itemsPerPage$))("totalItems",r(44,62,c.totalItems$))("currentPage",r(45,64,c.currentPage$)),i(5),p("heading",r(47,66,"common.id")),i(3),p("heading",r(50,68,"common.created-at")),i(3),p("heading",r(53,70,"system.job-queue-name"))("optional",!1),i(3),p("heading",r(56,72,"system.job-data"))("optional",!1),i(3),p("heading",r(59,74,"system.job-state")),i(3),p("heading",r(62,76,"system.job-duration")),i(3),p("heading",r(65,78,"system.job-result")))},dependencies:[I,ve,be,_e,x,fe,ge,he,je,Te,Se,Ee,R,J,M,S,Pe,Ce,ye,xe,Ie,De,F,Ne,we,q,H,O,A,Ge,D,w,Le,Je,Fe],styles:[`.result-detail[_ngcontent-%COMP%]{margin:0 12px}.retry-info[_ngcontent-%COMP%]{margin-inline-start:6px;color:var(--color-grey-400)}
/*# sourceMappingURL=job-list.component-EORJPWOH.css.map */`],changeDetection:0})}}return e})();var $e=[{path:"jobs",component:Ue,data:{breadcrumb:"breadcrumb.job-queue"}},{path:"system-status",component:He,data:{breadcrumb:"breadcrumb.system-status"}}];var li=(()=>{class e{static{this.\u0275fac=function(s){return new(s||e)}}static{this.\u0275mod=K({type:e})}static{this.\u0275inj=z({imports:[Me,ue.forChild($e)]})}}return e})();export{He as HealthCheckComponent,Ue as JobListComponent,Ge as JobStateLabelComponent,li as SystemModule,$e as systemRoutes};
//# sourceMappingURL=chunk-PXEUBHZ2.js.map
